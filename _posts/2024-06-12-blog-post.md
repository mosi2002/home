---
title: 'Bachelor thesis'
date: 2024-06-12
permalink: /posts/2024/05/bachelor-thesis/
tags:
  - Nonlinear state estimation
  - Chen-Fliess Series
  - Gradient Decent
  - Optimization
---

This is blog for my Bsc thesis about Neural network based state estimation using Lie derivative.


## Introduction
This thesis focuses on problem of state estimation for **Non-linear Dynamics**. The problem with model-based observer is due to the need of solving PDEs. In this thesis i used **Gradient Decent (GD)** for updating lie derivatives and also by considering the observer dynamics as a Chen-Fliess series, the estimaton has minimum error. The proposed approach is demonstrated by oscillating system.

## Problem Formulation
For This Nonlinear system, Assume:

$$
\dot{x(t)} = F(x(t)),
y(t) = H(x(t))
$$

The observer suggest that by considering this linear form:

$$
\dot{z} = Az + By,
\hat{x} = T^{-1}(z)
$$

we can have an estimation about states. It is required that 1) (A, B) should be controllable 2) A should be Hurwitz and 3) T is can be inversed!
In additionally, it's required T to be obtain:

$$
\frac{\partial T}{\partial x}(x) F(x) = AT(x) + BH(x)
$$

Now the challenging part is due the part to solve above equation. The cost of solving Lie derivative of T along F(x) is high. So in this Thesis we define the observer we designed as **[Chen-Flies Series](https://github.com/iperezav/CFSpy)**:

$$
\dot{z} = g_0(z) + g_1(z)y + g_2(z)y + ... ,
\hat{x} = h(z)
$$

and

$$
Lie_g(h) = \frac{\partial h}{\partial z} g(z)
$$

and for estimation:

$$
\hat{x_j}(t + \Delta) = \sum_{k=0}^{\infty} \sum_{\mu \in \ell_k^m} L_{\mu} h_j(z(t)) E_{\mu}(t, t + \Delta)
$$

also we used online Least-Squares for Chen-Fliess:

$$
\\min_{\\theta_j} J(\\theta_j, t) := \\frac{1}{2} \\int_0^\\Delta \\left( \\theta_j^T \\phi(t, \\delta) - x_j(t + \\delta) \\right)^2 d\\delta.
$$

and

$$
\\Phi(t) := \\int_0^\\Delta \\phi(t, \\delta) \\phi^T(t, \\delta) d\\delta \\geq \\alpha \\Delta I.
$$

the assumption shall be referred to as that of persistant excitation, Hence the optimal solution at time t + $$\Delta$$ can be found:

$$
\\theta_j^*(t) = \\Phi^{-1}(t) \\psi_j(t), \\text{ where } \\psi_j(t) = \\int_0^\\Delta x_j(t + \\delta) \\phi(t, \\delta) d\\delta, \\quad j = 1, \\dots, n.
$$

## Case Study
Let's Assume this oscillating system:

$$
\\dot{x_1} = 1 + x_1^2 x_2 - 4x_1, \\quad \\dot{x_2} = 3x_1 - x_1^2 x_2
$$

## Results

![image](https://github.com/user-attachments/assets/e7196ac5-2d5e-4d16-9b08-349787b7e98b)

The proposed method for estimation yielded an average error of 0.36, which demonstrates a reasonable level of accuracy considering the complexity of the problem. While not perfect, this error margin falls within an acceptable range for many real-world applications, where slight deviations can be tolerated. Also there is potential of improvements for lower the error by changing hyperparameters in observer and also the way of calculating integrals (simpson and ...).
.

